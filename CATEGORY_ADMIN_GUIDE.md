# Руководство по созданию категорий через админку

Пошаговая инструкция по созданию корневых категорий и подкатегорий в админ-панели Django.

---

## Важные понятия

- **Тип категории (CategoryType)** — логическая группа: медицина, БАДы, парфюмерия, посуда и т.д. У каждого типа свой slug (например, `perfumery`, `medicines`).
- **Корневая категория** — категория без родителя (`parent` пусто). Отображается на странице `/categories` и в навигации.
- **Подкатегория** — категория с указанным родителем. Отображается в сайдбаре на странице категории.

---

## Шаг 1: Проверка типа категории

Для существующих типов (медицина, БАДы, парфюмерия, посуда и т.д.) тип уже настроен.

1. Войдите в админку: `/admin/`
2. Откройте **Каталог** → **Типы категорий** (CategoryType)
3. Убедитесь, что нужный тип есть в списке (например, `perfumery` — «Парфюмерия»)

Если типа нет — создайте его:

- Нажмите **Добавить тип категории**
- **Название**: например, «Парфюмерия»
- **Slug**: `perfumery` (латиница, без пробелов; заполняется автоматически из названия)
- **Описание**: краткое описание
- **Активен**: включено
- **Порядок сортировки**: число (например, 20)
- Сохраните

---

## Шаг 2: Создание корневой категории

1. Откройте раздел, соответствующий нужному типу:
   - **Каталог** → **Категории — Парфюмерия** (для парфюмерии)
   - **Каталог** → **Категории — Медицина** (для медицины)
   - **Каталог** → **Категории — Посуда** (для посуды)
   - и т.д.

2. Нажмите **Добавить категорию**

3. Заполните поля:
   - **Название**: например, «Парфюмерия»
   - **Slug**: например, `perfumery` (генерируется из названия, можно править)
   - **Описание**: краткое описание категории
   - **Тип категории**: выберите нужный тип (часто подставляется автоматически)
   - **Родитель**: оставьте пустым — это корневая категория
   - **Активен**: включено
   - **Порядок сортировки**: 0 для корня

4. В блоке **Переводы** при необходимости добавьте переводы (ru, en).

5. Сохраните.

---

## Шаг 3: Создание подкатегорий

1. В том же разделе (например, **Категории — Парфюмерия**) нажмите **Добавить категорию**

2. Заполните поля:
   - **Название**: например, «Женская парфюмерия»
   - **Slug**: например, `women-perfume`
   - **Описание**: краткое описание
   - **Тип категории**: тот же тип, что у корня
   - **Родитель**: выберите созданную корневую категорию — в списке показываются только категории того же типа

3. Сохраните.

4. Повторите для остальных подкатегорий.

---

## Разделы админки по типам

| Тип в админке | Slug типа | Ссылка на фронте |
|---------------|-----------|-------------------|
| Категории — Медицина | `medicines` | `/categories/medicines` |
| Категории — БАДы | `supplements` | `/categories/supplements` |
| Категории — Парфюмерия | `perfumery` | `/categories/perfumery` |
| Категории — Посуда | `tableware` | `/categories/tableware` |
| Категории — Мебель | `furniture` | `/categories/furniture` |
| Категории — Аксессуары | `accessories` | `/categories/accessories` |
| Категории — Украшения | `jewelry` | `/categories/jewelry` |
| Категории — Нижнее бельё | `underwear` | `/categories/underwear` |
| Категории — Головные уборы | `headwear` | `/categories/headwear` |
| Категории — Услуги | `uslugi` | `/categories/uslugi` |
| Категории — Медтехника | `medical-equipment` | `/categories/medical-equipment` |

---

## Локализация на фронте

Чтобы подкатегории отображались корректно на сайте, добавьте переводы в:

- `frontend/public/locales/ru/common.json`
- `frontend/public/locales/en/common.json`

Формат ключей:

```json
"category_{slug}_name": "Название",
"category_{slug}_description": "Описание"
```

Пример для подкатегории `women-perfume`:

```json
"category_women-perfume_name": "Женская парфюмерия",
"category_women-perfume_description": "Женские ароматы"
```

---

## Частые ошибки

### 1. Подкатегории не отображаются в сайдбаре

- Проверьте, что **Родитель** у подкатегории указывает на корневую категорию.
- Убедитесь, что slug корневой категории совпадает с тем, что используется в URL (`/categories/{slug}`).
- Для парфюмерии используйте slug `perfumery` для корня.

### 2. В списке «Родитель» нет нужной категории

- В списке родителя показываются только категории того же типа.
- Убедитесь, что корневая категория создана и активна.
- Корневая категория должна быть в том же разделе админки, что и подкатегории.

### 3. Подкатегория «привязана» к чужой категории

- Не выбирайте родителя из другого типа (например, посуду для парфюмерии).
- Админка ограничивает выбор родителя категориями того же типа.

### 4. Дублирование корневых категорий

- Не создавайте несколько корневых категорий одного типа с разными slug.
- Используйте один slug для корня (например, `perfumery`).

---

## Добавление нового типа категорий

Если нужен новый тип (например, «Косметика»), которого нет в списке:

1. Создайте **CategoryType** в разделе «Типы категорий».
2. Добавьте новый прокси-админ в `backend/apps/catalog/admin.py` (аналогично `CategoryPerfumeryAdmin`).
3. Добавьте поддержку типа в `models.py`, `views.py`, `serializers.py` и на фронте.
4. Добавьте переводы в `common.json`.

Требуются изменения в коде; при необходимости обратитесь к разработчику.

---

## Чек-лист при создании категории

- [ ] Тип категории существует в «Типы категорий»
- [ ] Корневая категория: **Родитель** пустой
- [ ] Подкатегории: **Родитель** = корневая категория того же типа
- [ ] Slug на латинице, без пробелов (можно дефисы)
- [ ] **Активен** включён
- [ ] Переводы добавлены в `common.json` (ru/en)
