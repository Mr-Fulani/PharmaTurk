---
description:
globs:
alwaysApply: false
---


Техническое задание — MVP интернет-магазина Turk-Export

Цель: Создать мультикатегорийную онлайн-платформу для поиска, заказа и оплаты турецких медикаментов, БАДов, одежды и обуви с автоматическим обновлением данных, высокой производительностью и масштабируемой микросервисной архитектурой.

⸻

1. Архитектура и технологии

1.1 Стек технологий
	•	Backend: Django + Django REST Framework
	•	Frontend: Next.js  (React, SSR, TypeScript) или Nuxt.js 3+ (Vue, SSR, TypeScript)
	•	База данных: PostgreSQL 15+ с расширениями pg_trgm и при необходимости postgis
	•	Кэширование: Redis
	•	Фоновые задачи: Celery 5.x + Redis (с поддержкой asyncio)
	•	Поиск: Elasticsearch 8.x или OpenSearch
	•	Управление зависимостями Python: Poetry
	•	Контейнеризация: Docker (оптимизированные slim-образы)
	•	Оркестрация: docker-compose для разработки, Kubernetes для продакшена
	•	API Gateway: Traefik/Kong/NGINX (маршрутизация и безопасность)
	•	CI/CD: GitHub Actions или GitLab CI с авто-тестированием и деплоем
	•	Мониторинг и логирование: Sentry (ошибки), Prometheus + Grafana (метрики), централизованный лог-стек (ELK или Loki+Grafana)
	•	CDN: CloudFlare для статики и изображений

1.2 Микросервисы
	•	Парсер данных: интеграция с Vapi API, API брендов, headless-парсинг сайтов с fallback
	•	Каталог и ценообразование: хранение и обработка товаров, динамические наценки, акции
	•	Заказы и платежи: оформление, интеграция с ЮKassa, CloudPayments, криптовалюты, банковские переводы
	•	Доставка и трекинг: интеграция с СДЭК, Почта РФ, DPD и локальными турецкими курьерскими службами
	•	Уведомления: Email, Telegram, Push (web), SMS (опционально)
	•	Пользовательский сервис: аутентификация (JWT, OAuth), профиль, история заказов
	•	Административная панель: управление товарами, заказами, аналитика, акции, настройки доставки

⸻

2. Функционал MVP

2.1 Пользовательская часть
	•	Каталог с фильтрами по категориям, брендам, цене, форме выпуска
	•	Поиск с автодополнением и полнотекстовым индексом
	•	Карточка товара с фото, описанием, составом, показаниями, противопоказаниями, историей цен
	•	Корзина с сохранением для гостей (localStorage), детализацией стоимости
	•	Оформление заказа с выбором доставки и оплаты, валидация формы
	•	Личный кабинет: профиль, история заказов, трекинг, избранное, адресная книга
	•	Уведомления о статусах через Email, Telegram, Push

2.2 Административная панель
	•	Управление товарами (CRUD, массовое редактирование, импорт/экспорт CSV/Excel)
	•	Настройка ценообразования и акций (глобальные, по категориям, товарам)
	•	Управление заказами и статусами, печать документов, экспорт
	•	Настройка и управление тарифами и зонами доставки
	•	Аналитика продаж, популярных товаров, конверсии
	•	Логи и аудит действий администраторов

2.3 Парсинг и обновление данных
	•	Автоматическое обновление цен (каждые 4-6 часов) и наличия (каждые 2 часа)
	•	Модульный парсер с поддержкой нескольких источников и fallback
	•	Кэширование и приоритезация очередей задач
	•	Нормализация и унификация данных для всех категорий

2.4 Безопасность
	•	HTTPS + HSTS
	•	CSP заголовки
	•	Защита от SQL-инъекций, XSS, CSRF, DDoS (rate limiting)
	•	Аутентификация: JWT с refresh, 2FA опционально, OAuth (Google, Яндекс)
	•	Шифрование чувствительных данных в БД
	•	PCI DSS для платежей

⸻

3. Нефункциональные требования
	•	Время загрузки главной страницы — < 2 секунды
	•	Высокая отказоустойчивость, graceful degradation
	•	Масштабируемость сервисов независимо
	•	Логирование в формате JSON, централизованный сбор логов
	•	Мониторинг метрик и алертинг критических ошибок
	•	Мультиязычность: русский, английский, турецкий
	•	Поддержка нескольких валют с конвертацией и локализацией
	•	Регулярные тесты: unit, integration, E2E (покрытие > 80%)
	•	Документация API (Swagger/OpenAPI), архитектурные решения (ADR), runbook для деплоя


наше общение и коммеетарии к коду только на русском