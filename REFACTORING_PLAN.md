# План рефакторинга категорий

## Проблема
Сейчас есть две системы категорий:
1. `Category` - для медицины, БАДов, медтехники и т.д.
2. `ClothingCategory`, `ShoeCategory`, `ElectronicsCategory` - отдельные модели

Это создает:
- Дублирование кода
- Невозможность использовать общие функции (переводы, API)
- Сложность поддержки

## Решение: Объединить в одну модель `Category`

### Шаг 1: Расширить модель `Category`

Добавить опциональные поля для специфичных типов:

```python
class Category(models.Model):
    # Существующие поля...
    
    # Новые опциональные поля для одежды/обуви/электроники
    gender = models.CharField(
        _("Пол"), 
        max_length=10, 
        choices=GENDER_CHOICES, 
        blank=True,
        null=True,
        help_text=_("Для категорий одежды и обуви")
    )
    clothing_type = models.CharField(
        _("Тип одежды"), 
        max_length=100, 
        blank=True,
        help_text=_("Для категорий одежды: платья, блузки, джинсы")
    )
    shoe_type = models.CharField(
        _("Тип обуви"), 
        max_length=100, 
        blank=True,
        help_text=_("Для категорий обуви: туфли, кроссовки, сапоги")
    )
    device_type = models.CharField(
        _("Тип устройства"), 
        max_length=100, 
        blank=True,
        help_text=_("Для категорий электроники: телефоны, ноутбуки, планшеты")
    )
```

### Шаг 2: Миграция данных

1. Создать миграцию для добавления новых полей
2. Написать data migration для переноса данных из `ClothingCategory`, `ShoeCategory`, `ElectronicsCategory` в `Category`
3. Обновить связи в `ClothingProduct`, `ShoeProduct`, `ElectronicsProduct`

### Шаг 3: Обновить код

1. Обновить сериализаторы
2. Обновить админку
3. Обновить API views
4. Обновить фронтенд

### Шаг 4: Удалить старые модели

После успешной миграции удалить:
- `ClothingCategory`
- `ShoeCategory`
- `ElectronicsCategory`

## Преимущества

✅ Единая модель для всех категорий
✅ Единая система переводов
✅ Единый API
✅ Проще поддерживать
✅ Меньше дублирования кода

## Риски

⚠️ Нужно перенести данные без потерь
⚠️ Нужно обновить все связи
⚠️ Возможны проблемы с существующими данными

## Альтернатива (быстрое решение)

Если полный рефакторинг сейчас невозможен, можно:

1. Создать абстрактную базовую модель `AbstractCategory`
2. Наследовать от неё все категории
3. Создать общий inline для переводов с использованием GenericForeignKey

Но это временное решение, полный рефакторинг всё равно нужен.

